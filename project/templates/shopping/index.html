{% extends "/base/base.html" %}

{% block title %}
    Shopping
{% endblock %}
{% block script %}
{% endblock %}
{% block style %}
    <link rel="stylesheet" href="{{ url_for('static',filename='css/shopping/index.css') }}">

    <style>
        .index-item-container-box {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;

        }

        .index-item-container {
            width: 80%;
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            justify-content: flex-start;
            align-content: flex-start;
            margin: auto;
            background-color: #f1f1f1;
        }

        .index-item {
            width: 270px;
            margin: 20px;
            padding: 5px;
            display: flex;
            flex-direction: column;
            flex-wrap: wrap;
            align-items: center;
            border: 3px solid lightgray;
        }

        .index-item:hover {
            border: 3px solid orange;
        }

        .index-item-image {
            width: 240px;
            height: 200px;
        }

        .index-item-image:hover {
            transform: scale(1.1);
            -ms-transform: scale(1.1);
            /* IE 9 */
            -webkit-transform: scale(1.1);
            /* Safari and Chrome */
            -o-transform: scale(1.1);
            /* Opera */
            -moz-transform: scale(1.1);
        }

        .index-product-view-title {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .product-view-title-text {
            display: flex;
            justify-content: space-around;
            align-items: center;
            width: 80%;
            height: 100px;
            color: #ff1393;
            background: -webkit-gradient(
                    linear,
                    left bottom,
                    right top,
                    color-stop(0.02, rgb(249, 188, 201)),
                    color-stop(0.51, rgb(243, 255, 76)),
                    color-stop(0.87, rgb(252, 207, 227))
            );
            background: -moz-linear-gradient(
                    left bottom,
                    rgb(249, 188, 201) 2%,
                    rgb(255, 228, 76) 51%,
                    rgb(252, 207, 227) 87%
            );
        }

        .index-item-text {
            width: 100%;
        }

        .index-item-text * {
            padding: 10px;
        }

        .index-item-price {
            color: mediumpurple;
            font-weight: bold;
            font-size: 20px;

        }

        .index-item-name {
            text-decoration: none;
            color: orange;
            font-size: 18px;
            font-weight: bold;
        }

        .index-item-name:hover {
            text-decoration: none;
            color: #d73290;
        }

        .index-product-recommendation-title {
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .product-recommendation-title-text {
            display: flex;
            justify-content: space-around;
            align-items: center;
            width: 80%;
            height: 100px;
            color: #ff1393;
            background: -webkit-gradient(
                    linear,
                    left bottom,
                    right top,
                    color-stop(0.02, rgb(249, 188, 201)),
                    color-stop(0.51, rgb(243, 255, 76)),
                    color-stop(0.87, rgb(252, 207, 227))
            );
            background: -moz-linear-gradient(
                    left bottom,
                    rgb(249, 188, 201) 2%,
                    rgb(255, 228, 76) 51%,
                    rgb(252, 207, 227) 87%
            );
        }
    </style>
{% endblock %}

{% block content %}

    <div class="index-container">
        <div class="index-upper">
            <img class="index-logo-img" src="../../static/image/shopping/img_4.png" alt="">
            <div class="index-search-box">
                <form action="#" method="post" name="search">
                    <input class="index-search-text">
                    <input class="index-search-submit-button" type="submit" value="">
                </form>
            </div>
            <div class="my-basket-box">
                <a class="index-basket-group" href="{{ url_for("cart.shopping_cart") }}">

                    <span class="index-basket-icon">
                        <p class="index-basket-text">My Shopping Cart</p>
                    <i class="fas fa-cart-arrow-down"></i>
                </span>
                </a>

            </div>
        </div>

        {#        hot items recommendation#}
        <div class="index-product-recommendation-title">
            <h1 class="product-recommendation-title-text">Recommendation</h1>
        </div>
        <div class="index-item-container-box">
            <div class="index-item-container">

                <div class="shell">
                    <ui class="index-banner-images-box">
                        <li class="index-banner-image"></li>
                        <li class="index-banner-image"></li>
                        <li class="index-banner-image"></li>
                    </ui>
                    <ui class="index-banner-min-images-box">
                        <li class="index-banner-min-image"></li>
                        <li class="index-banner-min-image"></li>
                        <li class="index-banner-min-image"></li>
                    </ui>
                    <div class="index-banner-button">
                        <div class="index-banner-button-left"></div>
                        <div class="index-banner-button-right"></div>
                    </div>
                </div>
            </div>
        </div>


    </div>


    <br>
    <br>


    {#        product viewing area#}
    <div class="index-product-view-title">
        <h1 class="product-view-title-text">Product Viewing</h1>
    </div>
    <div class="index-item-container-box">
        <div class="index-item-container">

            {% for item in items %}
                <div class="index-item">
                    <a href="{{ url_for("item.details", itemID=item.id) }}"> <img class="index-item-image"
                                                                                  src="{{ url_for('static', filename='uploaded_files/'+item.main_image_url) }}"
                                                                                  value="Item Image"></a>
                    <div class="index-item-text">
                        <p class="index-item-price">$ {{ item.price }}</p>
                        <a class="index-item-name"
                           href="{{ url_for("item.details", itemID=item.id) }}">{{ item.name }}</a>
                        <p class="index-item-inventory">{{ item.inventory }} in warehouse</p>
                        <p class="index-item-description">{{ item.description }}</p>
                    </div>


                </div>
            {% endfor %}


        </div>

    </div>

    {% block jsfoot %}
        <script>
            let left = document.querySelector(".index-banner-button-left")
            let right = document.querySelector(".index-banner-button-right")
            let min = document.querySelectorAll(".index-banner-min-image")
            let images = document.querySelector(".index-banner-images-box")
            // 先设置一个index用来计算和控制图片的位置，再设置一个time作为定时器
            let index = 0
            let time

            // 在这里先创建一个position为复用函数，作用就是结合index来定义当前图片的位置的
            function position() {
                images.style.top = (index * -100) + "%"
            }

            // 然后创建一个复用函数add为加函数，如果当前图片的位置值index大于等于当前图片数量的话，就说明超出了计算范围，所以得清零，如若不然index就加一
            function add() {
                if (index >= min.length - 1) {
                    index = 0
                } else {
                    index++
                }
            }

            // 反之desc为减函数，如果当前图片的位置值index小于1了，那么他的值就反弹到最顶端，也就是轮播图的最后面，如若不然index就减一
            function desc() {
                if (index < 1) {
                    index = min.length - 1
                } else {
                    index--
                }
            }

            // 创建一个timer来当做复用时间的函数，，每隔3秒钟index就加一，然后加入增加add函数和desc函数来判断一下，再加入定位函数
            function timer() {
                time = setInterval(() => {
                    index++
                    desc()
                    add()
                    position()
                }, 2000)
            }

            // 设置按钮，left为左边的按钮，因为点击时图片会反方向倒退，所以套入desc减函数进去，定位一下
            left.addEventListener("click", () => {
                desc()
                position()
                clearInterval(time)
                timer()
            })
            // 右边的按钮和左边也是差不多
            right.addEventListener("click", () => {
                add()
                position()
                clearInterval(time)
                timer()
            })
            // 在弄好左右两个按钮的时候，还需要生效下面的小图片按钮，
            // 先遍历一遍，然后获取当前点击的那个小图片按钮的值并赋值给index，随之跳转
            for (let i = 0; i < min.length; i++) {
                min[i].addEventListener("click", () => {
                    index = i
                    position()
                    clearInterval(time)
                    timer()
                })
            }
            // 将定时器开起来
            timer()
        </script>

    {% endblock %}



{% endblock %}
